<!--
Name: Hossameldin Shaihn

#2- I used the Force layout to vistualize all students as nodes, I used .linkDistance
attribute of the graph as a function of computed distance to get the relative location
between students.
I've added a feature that will allow user to choose two data variables to be mapped
to node color and node size visual encodings.

#3- For interactivity, user can do the following
    - Filter the distance range on a percenage scale
    - Resize links length to adjust the overall graph size.
    - Double click a node to highlight it and its surroundings.
    - Select a data variable to be mapped to node color and adjust cutoff based on which
      nodes will be colored red (for data points values less than the cuttoff) and blue
      (for data points values greater than the cutoff)
    - Select another data variable to be mapped to node size and adjust cutoff based on which
      nodes will be smaller in size (for data points values less than the cuttoff) and bigger
      in size (for data points values greater than the cutoff). User also can adjust the size
      difference between small and big node sizes.
 -->
<!DOCTYPE html>
<html>
  <head>
    <title>HW7 Template</title>
    <!-- <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css"> -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.10.4/themes/flick/jquery-ui.css">
    <link rel="stylesheet" href="https://rawgit.com/simeydotme/jQuery-ui-Slider-Pips/master/dist/jquery-ui-slider-pips.css">
    <style type="text/css">
    /* Any CSS style rules can go here */
    svg {
    border-style:solid;
    border-color:grey;
    }
    #instructions{
    border-style: solid;
    border-color: grey;
    position: absolute;
    top: 8px;
    left: 970px;
    width: 350px;
    height: 154px;
    }
    #nodecolor {
    border-style: solid;
    border-color: grey;
    position: absolute;
    top: 175px;
    left: 970px;
    width: 350px;
    height: 230px;
    }
    #nodesize {
    border-style: solid;
    border-color: grey;
    position: absolute;
    top: 417px;
    left: 970px;
    width: 350px;
    height: 280px;
    }
    h2{
    margin: auto;
    width: 140px;
    }
    li{
      margin-top:10px;
    }
    .title {
    margin: auto;
    width: 25%;
    margin-top: 10px;
    }
    .selection, .sliding{
    width: 90%;
    margin: auto;
    margin-top: 30px;
    margin-bottom: 25px;
    }
    /*color sliders*/
    #colorThresholdSlider .ui-slider-range { background: #D11C24; }
    #colorThresholdSlider.ui-slider { background: #2176C7; }
    .axis .domain {
    fill: none;
    stroke: #000;
    stroke-opacity: .3;
    stroke-width: 10px;
    stroke-linecap: round;
    }
    .axis .halo {
    fill: none;
    stroke: #ddd;
    stroke-width: 8px;
    stroke-linecap: round;
    }
    .axis .tick {
    font: 10px sans-serif;
    }
    .selecting circle {
    fill-opacity: .2;
    }
    .selecting circle.selected {
    stroke: #f00;
    }
    .slider .handle {
    fill: #fff;
    stroke: #000;
    stroke-opacity: .5;
    stroke-width: 1.25px;
    cursor: crosshair;
    }
    .axisDistScale {
    font: 10px sans-serif;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
    }
    .axisDistScale .domain {
    fill: none;
    stroke: #000;
    stroke-opacity: .3;
    stroke-width: 10px;
    stroke-linecap: round;
    }
    .axisDistScale .halo {
    fill: none;
    stroke: #ddd;
    stroke-width: 8px;
    stroke-linecap: round;
    }
    .sliderDistScale .handle {
    fill: #fff;
    stroke: #000;
    stroke-opacity: .5;
    stroke-width: 1.25px;
    cursor: crosshair;
    }
    </style>
  </head>
  <body>
    <div id="instructions">
      <h2>Instructions</h2>
      <ul style="list-style-type:disc">
        <li>
          Double click a node to hightlight it and its surroundings.
        </li>
        <li>
          Select two data variables to be mapped to node color and size.
        </li>
      </ul>
    </div>
    <div id="nodecolor">
      <div class="title">Node Color:</div>
      <div class="selection">
        <span>Select Feature:</span>
        <select id="colorOptions">
        </select>
      </div>
      <div class="sliding">
        <p>Threshold:</p>
        <div id="colorThresholdSlider"></div>
      </div>
    </div>
    <div id="nodesize">
      <div class="title">Node Size</div>
      <div class="selection">
        <span>Select Feature:</span>
        <select id="sizeOptions">
        </select>
      </div>
      <div class="sliding">
        <p>Size Difference:</p>
        <div id="sizeDiffSlider"></div>
      </div>
      <div class="sliding">
        <p>Threshold:</p>
        <div id="sizeThresholdSlider"></div>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-2.1.1.js"></script>
    <script src="https://code.jquery.com/ui/1.11.1/jquery-ui.js"></script>
    <script src="https://rawgit.com/simeydotme/jQuery-ui-Slider-Pips/master/dist/jquery-ui-slider-pips.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js" charset="utf-8"></script>
    <!--
    <script src="./javascript.js" charset="utf-8"></script>
     -->
    <script>
var width = 950,
  height = 750,
  padding = 20,
  // link scale domina min/max
  min = 0,
  max = 100,
  // distance min/max
  minDist = maxDist = 0,
  circleWidth = 7,
  //Toggle stores whether the highlighting is on
  toggle = 0,
  //Create an array logging what is connected to what
  linkedByIndex = {};

var palette = {
  "lightgray": "#819090",
  "gray": "#708284",
  "darkgray": "#475B62",
  "darkblue": "#0A2933",
  "darkerblue": "#042029",
  "paleryellow": "#FCF4DC",
  "paleyellow": "#EAE3xxCB",
  "yellow": "#A57706",
  "orange": "#BD3613",
  "red": "#D11C24",
  "pink": "#C61C6F",
  "purple": "#595AB7",
  "blue": "#2176C7",
  "green": "#259286",
  "yellowgreen": "#738A05"
};

// Student data from CSV file, includes questions values for each student:
var vertices = [{
  'Temperature': 75,
  'PCvMac': 54,
  'Pets': 45,
  'Siblings': 1,
  'SpendMoney': 40,
  'SleepHours': 7,
  'Camping': 5,
  'Cook': 69,
  'Photos': 961,
  'PhoneMinutes': 4000,
  'Facebook': 400,
  'DistanceBorn': 8699,
  'Shoe': 6,
  'Name': 'Sangeetha',
  'Countries': 3,
  'Age': 24,
  'Spicey': 75,
  'Publications': 0,
  'CS': 100,
  'Restaurants': 3,
  'PlacesLived': 3,
  'States': 2,
  'Books': 7,
  'PhoneApps': 70,
  'Extrovert': 45,
  'JobYears': 2
}, {
  'Temperature': 65,
  'PCvMac': 35,
  'Pets': 100,
  'Siblings': 2,
  'SpendMoney': 15,
  'SleepHours': 7,
  'Camping': 8,
  'Cook': 60,
  'Photos': 753,
  'PhoneMinutes': 330,
  'Facebook': 52,
  'DistanceBorn': 450,
  'Shoe': 7.5,
  'Name': 'Gracie',
  'Countries': 6,
  'Age': 23,
  'Spicey': 15,
  'Publications': 3,
  'CS': 100,
  'Restaurants': 2,
  'PlacesLived': 3,
  'States': 14,
  'Books': 12,
  'PhoneApps': 20,
  'Extrovert': 5,
  'JobYears': 4
}, {
  'Temperature': 77,
  'PCvMac': 95,
  'Pets': 1,
  'Siblings': 1,
  'SpendMoney': 90,
  'SleepHours': 5,
  'Camping': 5,
  'Cook': 60,
  'Photos': 500,
  'PhoneMinutes': 450,
  'Facebook': 600,
  'DistanceBorn': 7657,
  'Shoe': 10,
  'Name': 'Testing123',
  'Countries': 3,
  'Age': 25,
  'Spicey': 60,
  'Publications': 3,
  'CS': 90,
  'Restaurants': 4,
  'PlacesLived': 3,
  'States': 1,
  'Books': 3,
  'PhoneApps': 17,
  'Extrovert': 90,
  'JobYears': 2
}, {
  'Temperature': 78,
  'PCvMac': 50,
  'Pets': 70,
  'Siblings': 0,
  'SpendMoney': 50,
  'SleepHours': 7,
  'Camping': 0,
  'Cook': 40,
  'Photos': 500,
  'PhoneMinutes': 400,
  'Facebook': 50,
  'DistanceBorn': 7083,
  'Shoe': 8.5,
  'Name': 'Guangyue',
  'Countries': 3,
  'Age': 29,
  'Spicey': 1,
  'Publications': 2,
  'CS': 50,
  'Restaurants': 15,
  'PlacesLived': 3,
  'States': 10,
  'Books': 2,
  'PhoneApps': 20,
  'Extrovert': 40,
  'JobYears': 7
}, {
  'Temperature': 80,
  'PCvMac': 50,
  'Pets': 75,
  'Siblings': 1,
  'SpendMoney': 50,
  'SleepHours': 8,
  'Camping': 0,
  'Cook': 80,
  'Photos': 1000,
  'PhoneMinutes': 900,
  'Facebook': 450,
  'DistanceBorn': 12000,
  'Shoe': 8,
  'Name': 'Harsh',
  'Countries': 1,
  'Age': 22,
  'Spicey': 80,
  'Publications': 1,
  'CS': 80,
  'Restaurants': 2,
  'PlacesLived': 2,
  'States': 1,
  'Books': 2,
  'PhoneApps': 68,
  'Extrovert': 75,
  'JobYears': 0
}, {
  'Temperature': 70,
  'PCvMac': 90,
  'Pets': 80,
  'Siblings': 0,
  'SpendMoney': 20,
  'SleepHours': 7,
  'Camping': 0,
  'Cook': 80,
  'Photos': 200,
  'PhoneMinutes': 180,
  'Facebook': 300,
  'DistanceBorn': 7000,
  'Shoe': 8.5,
  'Name': 'Peng',
  'Countries': 1,
  'Age': 28,
  'Spicey': 50,
  'Publications': 7,
  'CS': 100,
  'Restaurants': 10,
  'PlacesLived': 3,
  'States': 11,
  'Books': 2,
  'PhoneApps': 30,
  'Extrovert': 30,
  'JobYears': 2
}, {
  'Temperature': 68,
  'PCvMac': 32,
  'Pets': 24,
  'Siblings': 1,
  'SpendMoney': 44,
  'SleepHours': 8,
  'Camping': 1,
  'Cook': 84,
  'Photos': 4404,
  'PhoneMinutes': 7200,
  'Facebook': 458,
  'DistanceBorn': 8500,
  'Shoe': 9,
  'Name': 'Anonymous1',
  'Countries': 2,
  'Age': 26,
  'Spicey': 88,
  'Publications': 0,
  'CS': 88,
  'Restaurants': 6,
  'PlacesLived': 14,
  'States': 5,
  'Books': 0,
  'PhoneApps': 48,
  'Extrovert': 24,
  'JobYears': 4
}, {
  'Temperature': 40,
  'PCvMac': 80,
  'Pets': 50,
  'Siblings': 1,
  'SpendMoney': 60,
  'SleepHours': 8,
  'Camping': 2,
  'Cook': 90,
  'Photos': 250,
  'PhoneMinutes': 500,
  'Facebook': 900,
  'DistanceBorn': 8680,
  'Shoe': 5,
  'Name': 'Ambika',
  'Countries': 1,
  'Age': 25,
  'Spicey': 80,
  'Publications': 1,
  'CS': 90,
  'Restaurants': 10,
  'PlacesLived': 2,
  'States': 7,
  'Books': 3,
  'PhoneApps': 15,
  'Extrovert': 80,
  'JobYears': 2
}, {
  'Temperature': 70,
  'PCvMac': 30,
  'Pets': 20,
  'Siblings': 1,
  'SpendMoney': 30,
  'SleepHours': 7,
  'Camping': 0,
  'Cook': 30,
  'Photos': 100,
  'PhoneMinutes': 300,
  'Facebook': 130,
  'DistanceBorn': 5910,
  'Shoe': 12,
  'Name': 'Shahin',
  'Countries': 5,
  'Age': 39,
  'Spicey': 40,
  'Publications': 0,
  'CS': 70,
  'Restaurants': 10,
  'PlacesLived': 4,
  'States': 1,
  'Books': 2,
  'PhoneApps': 60,
  'Extrovert': 30,
  'JobYears': 13
}, {
  'Temperature': 73,
  'PCvMac': 1,
  'Pets': 30,
  'Siblings': 1,
  'SpendMoney': 70,
  'SleepHours': 7,
  'Camping': 200,
  'Cook': 70,
  'Photos': 200,
  'PhoneMinutes': 1800,
  'Facebook': 428,
  'DistanceBorn': 8735,
  'Shoe': 6.5,
  'Name': 'Jagathshree',
  'Countries': 3,
  'Age': 24,
  'Spicey': 70,
  'Publications': 0,
  'CS': 90,
  'Restaurants': 2,
  'PlacesLived': 7,
  'States': 5,
  'Books': 0,
  'PhoneApps': 96,
  'Extrovert': 50,
  'JobYears': 2
}, {
  'Temperature': 68,
  'PCvMac': 10,
  'Pets': 95,
  'Siblings': 0,
  'SpendMoney': 60,
  'SleepHours': 6.5,
  'Camping': 0,
  'Cook': 60,
  'Photos': 200,
  'PhoneMinutes': 120,
  'Facebook': 284,
  'DistanceBorn': 7500,
  'Shoe': 9.5,
  'Name': 'Anonymous2',
  'Countries': 8,
  'Age': 31,
  'Spicey': 30,
  'Publications': 16,
  'CS': 100,
  'Restaurants': 15,
  'PlacesLived': 2,
  'States': 12,
  'Books': 0,
  'PhoneApps': 20,
  'Extrovert': 50,
  'JobYears': 6
}, {
  'Temperature': 75,
  'PCvMac': 25,
  'Pets': 100,
  'Siblings': 1,
  'SpendMoney': 40,
  'SleepHours': 7,
  'Camping': 3,
  'Cook': 75,
  'Photos': 550,
  'PhoneMinutes': 10,
  'Facebook': 1035,
  'DistanceBorn': 620,
  'Shoe': 6,
  'Name': 'Audrey',
  'Countries': 1,
  'Age': 22,
  'Spicey': 60,
  'Publications': 0,
  'CS': 90,
  'Restaurants': 30,
  'PlacesLived': 2,
  'States': 20,
  'Books': 1,
  'PhoneApps': 170,
  'Extrovert': 25,
  'JobYears': 0
}, {
  'Temperature': 72,
  'PCvMac': 60,
  'Pets': 60,
  'Siblings': 0,
  'SpendMoney': 40,
  'SleepHours': 8,
  'Camping': 2,
  'Cook': 80,
  'Photos': 200,
  'PhoneMinutes': 500,
  'Facebook': 0,
  'DistanceBorn': 7245,
  'Shoe': 7,
  'Name': 'Jing',
  'Countries': 2,
  'Age': 30,
  'Spicey': 10,
  'Publications': 1,
  'CS': 60,
  'Restaurants': 15,
  'PlacesLived': 4,
  'States': 7,
  'Books': 0,
  'PhoneApps': 22,
  'Extrovert': 45,
  'JobYears': 6
}, {
  'Temperature': 70,
  'PCvMac': 1,
  'Pets': 60,
  'Siblings': 1,
  'SpendMoney': 90,
  'SleepHours': 6,
  'Camping': 30,
  'Cook': 70,
  'Photos': 200,
  'PhoneMinutes': 1000,
  'Facebook': 800,
  'DistanceBorn': 10000,
  'Shoe': 8,
  'Name': 'Abhishek',
  'Countries': 2,
  'Age': 25,
  'Spicey': 70,
  'Publications': 0,
  'CS': 70,
  'Restaurants': 10,
  'PlacesLived': 7,
  'States': 4,
  'Books': 3,
  'PhoneApps': 30,
  'Extrovert': 70,
  'JobYears': 2
}, {
  'Temperature': 80,
  'PCvMac': 50,
  'Pets': 80,
  'Siblings': 3,
  'SpendMoney': 45,
  'SleepHours': 7,
  'Camping': 2,
  'Cook': 65,
  'Photos': 250,
  'PhoneMinutes': 100,
  'Facebook': 300,
  'DistanceBorn': 1000,
  'Shoe': 8.5,
  'Name': 'Gustavo',
  'Countries': 3,
  'Age': 27,
  'Spicey': 1,
  'Publications': 10,
  'CS': 100,
  'Restaurants': 6,
  'PlacesLived': 5,
  'States': 3,
  'Books': 0,
  'PhoneApps': 8,
  'Extrovert': 45,
  'JobYears': 4
}, {
  'Temperature': 75,
  'PCvMac': 50,
  'Pets': 50,
  'Siblings': 1,
  'SpendMoney': 50,
  'SleepHours': 7,
  'Camping': 3,
  'Cook': 1,
  'Photos': 10,
  'PhoneMinutes': 80,
  'Facebook': 300,
  'DistanceBorn': 300,
  'Shoe': 10,
  'Name': 'Anonymous3',
  'Countries': 5,
  'Age': 25,
  'Spicey': 1,
  'Publications': 0,
  'CS': 90,
  'Restaurants': 3,
  'PlacesLived': 5,
  'States': 8,
  'Books': 0,
  'PhoneApps': 30,
  'Extrovert': 50,
  'JobYears': 1
}, {
  'Temperature': 70,
  'PCvMac': 35,
  'Pets': 85,
  'Siblings': 1,
  'SpendMoney': 26.5,
  'SleepHours': 6,
  'Camping': 10,
  'Cook': 45,
  'Photos': 400,
  'PhoneMinutes': 75,
  'Facebook': 255,
  'DistanceBorn': 600,
  'Shoe': 10,
  'Name': 'Andrew',
  'Countries': 11,
  'Age': 22,
  'Spicey': 65,
  'Publications': 1,
  'CS': 100,
  'Restaurants': 12,
  'PlacesLived': 12,
  'States': 26,
  'Books': 5,
  'PhoneApps': 35,
  'Extrovert': 35,
  'JobYears': 2
}, {
  'Temperature': 77,
  'PCvMac': 80,
  'Pets': 85,
  'Siblings': 1,
  'SpendMoney': 25,
  'SleepHours': 6,
  'Camping': 33,
  'Cook': 75,
  'Photos': 2500,
  'PhoneMinutes': 80,
  'Facebook': 118,
  'DistanceBorn': 2700,
  'Shoe': 7.5,
  'Name': 'Michelle',
  'Countries': 3,
  'Age': 23,
  'Spicey': 50,
  'Publications': 0,
  'CS': 70,
  'Restaurants': 4,
  'PlacesLived': 4,
  'States': 11,
  'Books': 5,
  'PhoneApps': 18,
  'Extrovert': 40,
  'JobYears': 6
}, {
  'Temperature': 70,
  'PCvMac': 1,
  'Pets': 80,
  'Siblings': 2,
  'SpendMoney': 40,
  'SleepHours': 6,
  'Camping': 30,
  'Cook': 80,
  'Photos': 20,
  'PhoneMinutes': 400,
  'Facebook': 800,
  'DistanceBorn': 174,
  'Shoe': 12,
  'Name': 'T.C.',
  'Countries': 2,
  'Age': 27,
  'Spicey': 1,
  'Publications': 1,
  'CS': 100,
  'Restaurants': 27,
  'PlacesLived': 2,
  'States': 12,
  'Books': 7,
  'PhoneApps': 50,
  'Extrovert': 40,
  'JobYears': 3
}, {
  'Temperature': 80,
  'PCvMac': 50,
  'Pets': 50,
  'Siblings': 1,
  'SpendMoney': 50,
  'SleepHours': 6,
  'Camping': 50,
  'Cook': 100,
  'Photos': 150,
  'PhoneMinutes': 300,
  'Facebook': 500,
  'DistanceBorn': 8500,
  'Shoe': 10,
  'Name': 'Anonymous4',
  'Countries': 1,
  'Age': 25,
  'Spicey': 50,
  'Publications': 1,
  'CS': 100,
  'Restaurants': 10,
  'PlacesLived': 4,
  'States': 6,
  'Books': 5,
  'PhoneApps': 15,
  'Extrovert': 50,
  'JobYears': 2.5
}, {
  'Temperature': 85,
  'PCvMac': 20,
  'Pets': 40,
  'Siblings': 1,
  'SpendMoney': 40,
  'SleepHours': 6,
  'Camping': 0,
  'Cook': 90,
  'Photos': 5000,
  'PhoneMinutes': 3000,
  'Facebook': 400,
  'DistanceBorn': 1300,
  'Shoe': 7,
  'Name': 'Rachel',
  'Countries': 26,
  'Age': 21,
  'Spicey': 1,
  'Publications': 0,
  'CS': 70,
  'Restaurants': 12,
  'PlacesLived': 4,
  'States': 23,
  'Books': 4,
  'PhoneApps': 30,
  'Extrovert': 90,
  'JobYears': 1
}, {
  'Temperature': 70,
  'PCvMac': 50,
  'Pets': 60,
  'Siblings': 1,
  'SpendMoney': 55,
  'SleepHours': 7,
  'Camping': 2,
  'Cook': 75,
  'Photos': 150,
  'PhoneMinutes': 900,
  'Facebook': 583,
  'DistanceBorn': 8500,
  'Shoe': 7,
  'Name': 'Rathna',
  'Countries': 5,
  'Age': 27,
  'Spicey': 65,
  'Publications': 0,
  'CS': 90,
  'Restaurants': 16,
  'PlacesLived': 7,
  'States': 3,
  'Books': 5.5,
  'PhoneApps': 50,
  'Extrovert': 50,
  'JobYears': 4.5
}, {
  'Temperature': 23,
  'PCvMac': 70,
  'Pets': 50,
  'Siblings': 0,
  'SpendMoney': 70,
  'SleepHours': 6,
  'Camping': 0,
  'Cook': 60,
  'Photos': 1000,
  'PhoneMinutes': 60,
  'Facebook': 155,
  'DistanceBorn': 6997.261,
  'Shoe': 9,
  'Name': 'Anonymous5',
  'Countries': 1,
  'Age': 23,
  'Spicey': 75,
  'Publications': 2,
  'CS': 75,
  'Restaurants': 20,
  'PlacesLived': 9,
  'States': 1,
  'Books': 0,
  'PhoneApps': 61,
  'Extrovert': 70,
  'JobYears': 1
}, {
  'Temperature': 80,
  'PCvMac': 25,
  'Pets': 25,
  'Siblings': 2,
  'SpendMoney': 10,
  'SleepHours': 7,
  'Camping': 3,
  'Cook': 90,
  'Photos': 200,
  'PhoneMinutes': 1800,
  'Facebook': 836,
  'DistanceBorn': 8000,
  'Shoe': 8,
  'Name': 'Radha',
  'Countries': 3,
  'Age': 22,
  'Spicey': 85,
  'Publications': 2,
  'CS': 100,
  'Restaurants': 1,
  'PlacesLived': 3,
  'States': 1,
  'Books': 2,
  'PhoneApps': 12,
  'Extrovert': 75,
  'JobYears': 1
}, {
  'Temperature': 30,
  'PCvMac': 3,
  'Pets': 72,
  'Siblings': 1,
  'SpendMoney': 4,
  'SleepHours': 7,
  'Camping': 150,
  'Cook': 23,
  'Photos': 15,
  'PhoneMinutes': 65,
  'Facebook': 263,
  'DistanceBorn': 213.38,
  'Shoe': 11.5,
  'Name': 'Taylor',
  'Countries': 1,
  'Age': 21,
  'Spicey': 83,
  'Publications': 0,
  'CS': 94,
  'Restaurants': 9,
  'PlacesLived': 3,
  'States': 7,
  'Books': 4,
  'PhoneApps': 91,
  'Extrovert': 14,
  'JobYears': 3
}, {
  'Temperature': 80,
  'PCvMac': 1,
  'Pets': 50,
  'Siblings': 1,
  'SpendMoney': 15,
  'SleepHours': 8,
  'Camping': 2,
  'Cook': 95,
  'Photos': 100,
  'PhoneMinutes': 60,
  'Facebook': 670,
  'DistanceBorn': 250,
  'Shoe': 10,
  'Name': 'Adam',
  'Countries': 10,
  'Age': 23,
  'Spicey': 1,
  'Publications': 0,
  'CS': 70,
  'Restaurants': 15,
  'PlacesLived': 3,
  'States': 20,
  'Books': 0,
  'PhoneApps': 100,
  'Extrovert': 20,
  'JobYears': 3
}, {
  'Temperature': 78,
  'PCvMac': 60,
  'Pets': 90,
  'Siblings': 6,
  'SpendMoney': 49,
  'SleepHours': 7,
  'Camping': 6,
  'Cook': 70,
  'Photos': 4000,
  'PhoneMinutes': 1800,
  'Facebook': 250,
  'DistanceBorn': 4153,
  'Shoe': 11,
  'Name': 'Moeti',
  'Countries': 8,
  'Age': 36,
  'Spicey': 20,
  'Publications': 3,
  'CS': 95,
  'Restaurants': 3,
  'PlacesLived': 7,
  'States': 31,
  'Books': 8,
  'PhoneApps': 40,
  'Extrovert': 50,
  'JobYears': 8
}, {
  'Temperature': 77,
  'PCvMac': 15,
  'Pets': 75,
  'Siblings': 3,
  'SpendMoney': 50,
  'SleepHours': 7,
  'Camping': 4,
  'Cook': 60,
  'Photos': 201,
  'PhoneMinutes': 800,
  'Facebook': 600,
  'DistanceBorn': 3009,
  'Shoe': 10.5,
  'Name': 'Tomilayo',
  'Countries': 3,
  'Age': 27,
  'Spicey': 89,
  'Publications': 0,
  'CS': 50,
  'Restaurants': 5,
  'PlacesLived': 6,
  'States': 11,
  'Books': 4,
  'PhoneApps': 60,
  'Extrovert': 80,
  'JobYears': 5
}, {
  'Temperature': 80,
  'PCvMac': 1,
  'Pets': 58,
  'Siblings': 2,
  'SpendMoney': 19,
  'SleepHours': 7,
  'Camping': 8,
  'Cook': 49,
  'Photos': 397,
  'PhoneMinutes': 249,
  'Facebook': 806,
  'DistanceBorn': 300,
  'Shoe': 10,
  'Name': 'Derek',
  'Countries': 10,
  'Age': 26,
  'Spicey': 25,
  'Publications': 0,
  'CS': 50,
  'Restaurants': 14,
  'PlacesLived': 1,
  'States': 19,
  'Books': 2,
  'PhoneApps': 49,
  'Extrovert': 25,
  'JobYears': 3
}, {
  'Temperature': 80,
  'PCvMac': 10,
  'Pets': 25,
  'Siblings': 2,
  'SpendMoney': 10,
  'SleepHours': 7,
  'Camping': 3,
  'Cook': 90,
  'Photos': 200,
  'PhoneMinutes': 1800,
  'Facebook': 836,
  'DistanceBorn': 8736,
  'Shoe': 9,
  'Name': 'Radha',
  'Countries': 3,
  'Age': 22,
  'Spicey': 85,
  'Publications': 2,
  'CS': 100,
  'Restaurants': 1,
  'PlacesLived': 3,
  'States': 1,
  'Books': 2,
  'PhoneApps': 12,
  'Extrovert': 75,
  'JobYears': 1
}, {
  'Temperature': 70,
  'PCvMac': 25,
  'Pets': 75,
  'Siblings': 2,
  'SpendMoney': 15,
  'SleepHours': 7,
  'Camping': 250,
  'Cook': 85,
  'Photos': 500,
  'PhoneMinutes': 120,
  'Facebook': 383,
  'DistanceBorn': 575,
  'Shoe': 11.5,
  'Name': 'Dave',
  'Countries': 7,
  'Age': 24,
  'Spicey': 60,
  'Publications': 0,
  'CS': 25,
  'Restaurants': 5,
  'PlacesLived': 6,
  'States': 36,
  'Books': 20,
  'PhoneApps': 35,
  'Extrovert': 80,
  'JobYears': 3
}, {
  'Temperature': 80,
  'PCvMac': 80,
  'Pets': 50,
  'Siblings': 0,
  'SpendMoney': 40,
  'SleepHours': 7,
  'Camping': 9,
  'Cook': 60,
  'Photos': 1600,
  'PhoneMinutes': 800,
  'Facebook': 500,
  'DistanceBorn': 7086.12,
  'Shoe': 7.5,
  'Name': 'Tianyi',
  'Countries': 4,
  'Age': 23,
  'Spicey': 50,
  'Publications': 0,
  'CS': 85,
  'Restaurants': 7,
  'PlacesLived': 5,
  'States': 6,
  'Books': 5,
  'PhoneApps': 40,
  'Extrovert': 60,
  'JobYears': 0
}, {
  'Temperature': 75,
  'PCvMac': 99,
  'Pets': 10,
  'Siblings': 2,
  'SpendMoney': 40,
  'SleepHours': 9,
  'Camping': 100,
  'Cook': 2,
  'Photos': 880,
  'PhoneMinutes': 60,
  'Facebook': 5,
  'DistanceBorn': 300,
  'Shoe': 12,
  'Name': 'Chris',
  'Countries': 8,
  'Age': 45,
  'Spicey': 25,
  'Publications': 100,
  'CS': 90,
  'Restaurants': 30,
  'PlacesLived': 9,
  'States': 48,
  'Books': 4,
  'PhoneApps': 50,
  'Extrovert': 20,
  'JobYears': 20
}];
// List of question titles (numeric questions only, does not include 'Name'):
var questions = ['Age', 'Shoe', 'Siblings', 'SleepHours', 'Temperature', 'Pets', 'Extrovert', 'Cook', 'Spicey', 'Restaurants', 'SpendMoney', 'PhoneMinutes', 'PhoneApps', 'Photos', 'Facebook', 'PCvMac', 'CS', 'Books', 'DistanceBorn', 'Countries', 'States', 'PlacesLived', 'Camping', 'JobYears', 'Publications'];
var edges = []; // Computed distances between each pair of students
var scales = {}; // Computed min, max, and scale for each question attribute
var force; // D3 Force layout

// populate dropdown lists with questions
for (var i = 0; i < questions.length; i++) {
  $('<option/>').val(questions[i]).html(questions[i]).appendTo('#colorOptions');
  $('<option/>').val(questions[i]).html(questions[i]).appendTo('#sizeOptions');
}

// initialize sliders
$("#colorThresholdSlider")
  .slider({
    min: 0,
    max: 100,
    step: 5,
    range: "min",
    change: function(event, ui) {
      svg.selectAll(".node")
        .attr('fill', function(d, i) {
          if (d["norm-" + $("#colorOptions").val()] <= ui.value / 100) {
            return palette.red
          } else {
            return palette.blue
          }
        })
    }
  })
  .slider("pips", {
    handle: true,
  })
  .slider("float");

$("#sizeDiffSlider")
  .slider({
    min: 1,
    max: 5,
    step: 1,
    change: function(event, ui) {
      svg.selectAll(".node")
        .attr('r', function(d) {
          if (d["norm-" + $("#sizeOptions").val()] <= $("#sizeThresholdSlider").slider("value") / 100) {
            return circleWidth - ui.value;
          } else {
            return circleWidth + ui.value;
          }
        })
    }
  })
  .slider("pips", {
    handle: true,
  })
  .slider("float");

$("#sizeThresholdSlider")
  .slider({
    min: 0,
    max: 100,
    step: 5,
    change: function(event, ui) {
      svg.selectAll(".node")
        .attr('r', function(d) {
          if (d["norm-" + $("#sizeOptions").val()] <= ui.value / 100) {
            return circleWidth - $("#sizeDiffSlider").slider("value");
          } else {
            return circleWidth + $("#sizeDiffSlider").slider("value");
          }
        })
    }

  })
  .slider("pips", {
    handle: true,
  })
  .slider("float");

// Compute min/max ranges and scales for each data attribute
questions.forEach(function(q) {
  mn = d3.min(vertices, function(d) {
    return d[q];
  });
  mx = d3.max(vertices, function(d) {
    return d[q];
  });
  scales[q] = {
    min: mn,
    max: mx,
    scale: d3.scale.linear().domain([mn, mx]).range([0.0, 1.0])
  };
});

// Compute normalized vertex data for each attribute such that
// each student has {Age:value, norm-Age:value, ...}
vertices.forEach(function(d) {
  questions.forEach(function(q) {
    d["norm-" + q] = scales[q].scale(d[q]);
  });
});

// Compute edges as array of {source:idx, target:idx, distance:value}
// Uses normalized vertex data to compute edge distances in high-dimensional space
vertices.forEach(function(src, isrc) {
  vertices.forEach(function(dst, idst) {
    if (isrc < idst) {
      edges.push({
        source: isrc,
        target: idst,
        distance: dist(src, dst)
      });
    }
  });
});

minDist = d3.min(edges, function(d) {
  return d.distance;
});
maxDist = d3.max(edges, function(d) {
  return d.distance;
});

// distance linear scale
var distScale = d3.scale.linear()
  .domain([minDist, maxDist])
  .range([0, 100])
  .clamp(true);

// Distance metric -- computes euclidian distance between students using normalized attribute values
function dist(p1, p2) {
  dis = 0.0;
  questions.forEach(function(q) {
    dis += Math.pow(p1["norm-" + q] - p2["norm-" + q], 2);
  });
  return Math.sqrt(dis);
}

var svg = d3.select("body")
  .append("svg")
  .attr("width", width)
  .attr("height", height);

var distScaleMulti = 100
  // Set up the D3 Force layout with vertices and edges, and run it.Computes 2D locations
  // of students as vertices[i].x and.y that approximate their true distances in high - D.
force = d3.layout.force()
  .charge(-1000)
  .linkDistance(function(d) {
    return 2 * d.distance * distScaleMulti;
  })
  .size([width, height])
  .nodes(vertices)
  .links(edges)
  .start()
  .on("tick", tick)

var link = svg.selectAll("line")
  .data(edges)
  .enter()
  .append('line')
  .attr('stroke', palette.gray);

var node = svg.selectAll(".node")
  .data(vertices)
  .enter()
  .append('g')
  .call(force.drag)
  .on('dblclick', connectedNodes); //Added code


node
  .append("circle")
  .attr("class", "node")
  .attr('cx', function(d) {
    return d.cx;
  })
  .attr('cy', function(d) {
    return d.cy;
  })
  .attr('r', function(d) {
    if (d["norm-" + $("#sizeOptions").val()] <= $("#sizeThresholdSlider").slider("value") / 100) {
      return circleWidth - $("#sizeDiffSlider").slider("value");
    } else {
      return circleWidth + $("#sizeDiffSlider").slider("value");
    }
  })
  .attr('fill', function(d, i) {
    if (d["norm-" + $("#colorOptions").val()] <= $("#colorThresholdSlider").slider("value") / 100) {
      return palette.red
    } else {
      return palette.blue
    }
  })

$("#colorOptions").change(function() {
  svg.selectAll(".node")
    .attr('fill', function(d, i) {
      if (d["norm-" + $("#colorOptions").val()] <= $("#colorThresholdSlider").slider("value") / 100) {
        return palette.red
      } else {
        return palette.blue
      }
    })
});

$("#sizeOptions").change(function() {
  svg.selectAll(".node")
    .attr('r', function(d) {
      if (d["norm-" + $("#sizeOptions").val()] <= $("#sizeThresholdSlider").slider("value") / 100) {
        return circleWidth - $("#sizeDiffSlider").slider("value");
      } else {
        return circleWidth + $("#sizeDiffSlider").slider("value");
      }
    })
});

node
  .append('text')
  .text(function(d) {
    return d.Name;
  })
  .attr('fill', palette.darkblue)
  .attr('x', function(d, i) {
    return 15;
  })
  .attr('y', function(d, i) {
    return 5;
  })
  .attr('text-anchor', 'beginning');

// distance filter slider text
svg.append("text")
  .attr("x", 10)
  .attr("y", 25)
  .style("font-size", "16px")
  .text("Distance Filter: ")
  .attr("font-family", "sans-serif")
  .attr("font-size", "20px")
  .attr("fill", "Black");;

// Axis linear scale
var x = d3.scale.linear()
  .domain([min, max])
  .range([padding + 100, width - 6 * padding])
  .clamp(true);

var xAxis = d3.svg.axis()
  .scale(x)
  .tickSize(0)
  .tickPadding(12);

var brush = d3.svg.brush()
  .x(x)
  .extent([min, max])
  .on("brush", brushed)
  .on("brushend", function() {
    slider.selectAll(".resize.s")
      .style("display", "inline")
  });

//append stuff
var slidercontainer = svg.append("g")
  .attr("transform", "translate(" + padding + ", " + padding + ")");

var axis = slidercontainer.append("g")
  .attr("class", "axis")
  .call(xAxis);

var slider = slidercontainer.append("g")
  .call(brush)
  .classed("slider", true);

//manipulate stuff
d3.selectAll(".slider .resize")
  .append("circle")
  .attr("cx", 0)
  .attr("cy", 0)
  .attr("r", 10)
// .attr("fill", "red")
.classed("handle", true);

d3.select(".axis .domain")
  .select(function() {
    return this.parentNode.appendChild(this.cloneNode(true))
  })
  .classed("halo", true);

function brushed() {
  var lower = min,
    upper = max;

  if (brush.extent()[0] > brush.extent()[1]) {
    lower = brush.extent()[1];
    upper = brush.extent()[0];
  } else {
    lower = brush.extent()[0];
    upper = brush.extent()[1];
  }

  svg.selectAll("line")
    .style("stroke-width", function(d) {
      return distScale(d.distance) >= lower && distScale(d.distance) <= upper ? 1 : 0;
    });
}

// distance scale slider text
svg.append("text")
  .attr("x", 10)
  .attr("y", 75)
  .style("font-size", "16px")
  .text("Distance Scale: ")
  .attr("font-family", "sans-serif")
  .attr("font-size", "20px")
  .attr("fill", "Black");

var margin = {
    top: 200,
    right: 50,
    bottom: 200,
    left: 50
  },
  widthDistScale = 960 - margin.left - margin.right,
  heightDistScale = 500 - margin.bottom - margin.top;

var xDistScale = d3.scale.linear()
  .domain([min, max])
  .range([padding + 100, width - 6 * padding])
  .clamp(true);

var brushDistScale = d3.svg.brush()
  .x(xDistScale)
  .extent([0, 0])
  .on("brush", brushedDistScale);

var sliderDistScaleContainer = svg.append("g")
  .attr("transform", "translate(" + padding + ", " + padding + ")");
// .attr("transform", "translate(0," + heightDistScale / 2 + ")");

sliderDistScaleContainer
  .append("g")
  .attr("class", "xDistScale axisDistScale")
  .attr("transform", "translate(0," + heightDistScale / 2 + ")")
  .call(d3.svg.axis()
    .scale(xDistScale)
    .tickSize(0)
    .tickPadding(12))
  .select(".domain")
  .select(function() {
    return this.parentNode.appendChild(this.cloneNode(true));
  })
  .attr("class", "halo");

var sliderDistScale = sliderDistScaleContainer.append("g")
  .attr("class", "sliderDistScale")
  .call(brushDistScale);

sliderDistScale.selectAll(".extent,.resize,.background")
  .remove();

// sliderDistScale.select(".background")
//   .remove();
// .attr("height", 100);

var handle = sliderDistScale.append("circle")
  .attr("class", "handle")
  .attr("transform", "translate(" + (padding + 100) + "," + heightDistScale / 2 + ")")
  .attr("r", 10);

sliderDistScale
  .call(brushDistScale.event)
  .transition()
  .duration(750)
  .call(brushDistScale.extent([max, max]))
  .call(brushDistScale.event);

function brushedDistScale() {
  var value = brushDistScale.extent()[0];

  if (d3.event.sourceEvent) { // not a programmatic event
    value = xDistScale.invert(d3.mouse(this)[0]);

    brushDistScale.extent([value, value]);
  }
  handle.attr("cx", xDistScale(value) - (padding + 100));
  distScaleMulti = value;
  force.start();
  // d3.select("body").style("background-color", d3.hsl(value, .8, .8));
}

for (i = 0; i < vertices.length; i++) {
  linkedByIndex[i + "," + i] = 1;
};

edges.forEach(function(d) {
  linkedByIndex[d.source.index + "," + d.target.index] = 1;
});

//This function looks up whether a pair are neighbours
function neighboring(a, b) {
  return linkedByIndex[a.index + "," + b.index];
}

function connectedNodes() {
  if (toggle == 0) {
    //Reduce the opacity of all but the neighbouring nodes
    d = d3.select(this).node().__data__;
    node.style("opacity", function(o) {
      return neighboring(d, o) | neighboring(o, d) ? 1 : 0.1;
    });

    link.style("opacity", function(o) {
      return d.index == o.source.index | d.index == o.target.index ? 1 : 0.1;
    });
    link.attr("stroke", function(o) {
      return d.index == o.source.index | d.index == o.target.index ? palette.yellowgreen : palette.gray;
    });

    //Reduce the op
    toggle = 1;
  } else {
    //Put them back to opacity=1
    node.style("opacity", 1);
    link.style("opacity", 1);
    link.attr("stroke", palette.gray);
    toggle = 0;
  }
}

function tick() {
  link
    .attr("x1", function(d) {
      return d.source.x;
    })
    .attr("y1", function(d) {
      return d.source.y;
    })
    .attr("x2", function(d) {
      return d.target.x;
    })
    .attr("y2", function(d) {
      return d.target.y;
    });

  node.attr('transform', function(d, i) {
    return 'translate(' + d.x + ', ' + d.y + ')';
  })
};

    </script>
  </body>
</html>

